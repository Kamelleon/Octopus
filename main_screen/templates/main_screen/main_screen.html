{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Octopus - Cameras view</title>
    <link rel="stylesheet" href="{% static '/css/main_screen_style.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="logo"><img src="{% static '/img/Octopus_logo_black.svg' %}" alt="octpus_logo_black"></div>
    <a href="{% url 'logout' %}">Logout</a>
    <br>
    {% for camera in camera_objects %}
        <a href="{% url 'camera-details' camera.id %}"><div id="loading{{ forloop.counter }}">Connecting to a {{ camera.ip }}...</div></a>
        <img id="camera{{ forloop.counter }}" onload="loadImage{{ forloop.counter }}()" src="{% url 'rtsp-stream' rtsp_ip=camera.ip port=camera.port %}" alt='live-stream'>
        <div id="new_camera{{ forloop.counter }}"></div>
        <script>
        const myInterval{{ forloop.counter }} = setInterval(myTimer{{ forloop.counter }}, 30000);

        function loadImage{{ forloop.counter }}() {
            document.getElementById("loading{{ forloop.counter }}").remove();
        }

        function myTimer{{ forloop.counter }}() {
          document.getElementById("loading{{ forloop.counter }}").innerHTML = "{{ camera.name }} not responding";
          clearInterval(myInterval{{ forloop.counter }});
        }
        </script>
{#        <p><a href="{% url 'camera-details' camera.id %}">{{ forloop.counter }} - {{ camera.name }} ({{ camera.ip }})</a></p>#}
    {% endfor %}
</body>
</html>